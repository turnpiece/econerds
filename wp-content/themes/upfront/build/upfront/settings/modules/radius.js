define(["scripts/upfront/settings/modules/base-module"],function(e){var i=Upfront.Settings.l10n.preset_manager,d=e.extend({className:"settings_module corner_radius_settings_item clearfix",group:!1,get_title:function(){return this.options.title},initialize:function(e){this.options=e||{},this.options.max_value&&this.options.max_value<200&&(this.options.max_value=200),this.options.max_value||(this.options.max_value=200);var d=this,t=this.options.state,l=function(){var e=this.get_value(),s={};s[d.options.fields.radius1]=e,s[d.options.fields.radius2]=e,s[d.options.fields.radius3]=e,s[d.options.fields.radius4]=e,s[d.options.fields.radius]=e,d.model.set(s,{silent:!0}),d.model.set(d.options.fields.radius_number,e),d.$el.find("input[name="+d.options.fields.radius1+"]").val(e),d.$el.find("input[name="+d.options.fields.radius2+"]").val(e),d.$el.find("input[name="+d.options.fields.radius3+"]").val(e),d.$el.find("input[name="+d.options.fields.radius4+"]").val(e),d.$el.find("input[name="+d.options.fields.radius_number+"]").val(e),d.$el.closest(".state_modules").find("."+t+"-radius-slider").css("opacity",1)},a=_.throttle(l,16),o=function(e){s=d.fields._wrapped[2],s.$el.find("#"+s.get_field_id()).slider("value",e),s.get_field().val(e),l.apply(s),e>d.options.max_value?d.$el.closest(".state_modules").find("."+t+"-radius-slider").css("opacity",.6):d.$el.closest(".state_modules").find("."+t+"-radius-slider").css("opacity",1)},r=_.throttle(o,16);this.fields=_([new Upfront.Views.Editor.Field.Checkboxes({model:this.model,className:"useRadius checkbox-title",name:d.options.fields.use,label:"",default_value:1,multiple:!1,values:[{label:i.rounded_corners,value:"yes"}],change:function(e){d.model.set(d.options.fields.use,e),d.reset_fields(e)},show:function(e,s){var i=s.closest(".state_modules"),l=d.model.get(d.options.fields.lock);"yes"==e?"yes"==l?(i.find("."+t+"-radius-slider").show(),i.find("."+t+"-radius-slider-number").show()):(i.find("."+t+"-radius-slider").hide(),i.find("."+t+"-radius-slider-number").hide(),i.find("."+t+"-radius1").show(),i.find("."+t+"-radius2").show(),i.find("."+t+"-radius3").show(),i.find("."+t+"-radius4").show()):(i.find("."+t+"-radius1").hide(),i.find("."+t+"-radius2").hide(),i.find("."+t+"-radius3").hide(),i.find("."+t+"-radius4").hide(),i.find("."+t+"-radius-slider").hide(),i.find("."+t+"-radius-slider-number").hide())}}),new Upfront.Views.Editor.Field.Checkboxes({model:this.model,className:t+"-radius-lock border_radius_lock",name:d.options.fields.lock,label:"",default_value:0,multiple:!1,values:[{label:"",value:"yes"}],show:function(e){d.model.set(d.options.fields.lock,e);var s=d.$el.closest(".state_modules"),i=d.model.get(d.options.fields.use);"yes"==e&&"yes"==i?(s.find("."+t+"-radius-slider").show(),s.find("."+t+"-radius-slider-number").show(),s.find("."+t+"-radius1").hide(),s.find("."+t+"-radius2").hide(),s.find("."+t+"-radius3").hide(),s.find("."+t+"-radius4").hide()):"yes"==i&&(s.find("."+t+"-radius-slider").hide(),s.find("."+t+"-radius-slider-number").hide(),s.find("."+t+"-radius1").show(),s.find("."+t+"-radius2").show(),s.find("."+t+"-radius3").show(),s.find("."+t+"-radius4").show())}}),new Upfront.Views.Editor.Field.Slider({className:t+"-radius-slider upfront-field-wrap upfront-field-wrap-slider radius-slider",model:this.model,name:d.options.fields.radius,suffix:i.px,min:0,max:d.options.max_value,step:10,change:a,show:function(){var e=d.model.get(d.options.fields.radius_number);e>d.options.max_value?d.$el.closest(".state_modules").find("."+t+"-radius-slider").css("opacity",.6):d.$el.closest(".state_modules").find("."+t+"-radius-slider").css("opacity",1)}}),new Upfront.Views.Editor.Field.Number({model:this.model,className:t+"-radius-slider-number border_radius_number",name:d.options.fields.radius_number,label:"",min:0,max:1e3,default_value:0,values:[{label:"",value:"0"}],change:r}),new Upfront.Views.Editor.Field.Number({model:this.model,className:t+"-radius1 border_radius border_radius1",name:d.options.fields.radius1,label:"",min:0,max:1e3,default_value:0,values:[{label:"",value:"0"}],change:function(e){d.model.set(d.options.fields.radius1,e)}}),new Upfront.Views.Editor.Field.Number({model:this.model,className:t+"-radius2 border_radius border_radius2 border_radius2_static",name:d.options.fields.radius2,label:"",min:0,max:1e3,default_value:0,values:[{label:"",value:"0"}],change:function(e){d.model.set(d.options.fields.radius2,e)}}),new Upfront.Views.Editor.Field.Number({model:this.model,className:t+"-radius4 border_radius border_radius4",name:d.options.fields.radius4,label:"",min:0,max:1e3,default_value:0,values:[{label:"",value:"0"}],change:function(e){d.model.set(d.options.fields.radius4,e)}}),new Upfront.Views.Editor.Field.Number({model:this.model,className:t+"-radius3 border_radius border_radius3",name:d.options.fields.radius3,label:"",min:0,max:1e3,default_value:0,values:[{label:"",value:"0"}],change:function(e){d.model.set(d.options.fields.radius3,e)}})])},reset_fields:function(e){if("undefined"!=typeof e&&"yes"===e){var s=this.get_static_field_values(e,this.options.prepend);this.update_fields(e,s),this.save_static_values(e,s),this.$el.empty(),this.render()}},save_static_values:function(e,s){this.model.set(this.options.fields.lock,s.lock),this.model.set(this.options.fields.radius,s.radius),this.model.set(this.options.fields.radius_number,s.radius_number),this.model.set(this.options.fields.radius1,s.radius1),this.model.set(this.options.fields.radius2,s.radius2),this.model.set(this.options.fields.radius3,s.radius3),this.model.set(this.options.fields.radius4,s.radius4)},get_static_field_values:function(e,s){var i={},d="";return"undefined"!=typeof this.options.prefix&&(d=this.options.prefix+"-"),i.lock=this.model.get(this.clear_prepend(d+this.options.fields.lock,s))||"",i.radius=this.model.get(this.clear_prepend(d+this.options.fields.radius,s))||"",i.radius_number=this.model.get(this.clear_prepend(d+this.options.fields.radius_number,s))||"",i.radius1=this.model.get(this.clear_prepend(d+this.options.fields.radius1,s))||"",i.radius2=this.model.get(this.clear_prepend(d+this.options.fields.radius2,s))||"",i.radius3=this.model.get(this.clear_prepend(d+this.options.fields.radius3,s))||"",i.radius4=this.model.get(this.clear_prepend(d+this.options.fields.radius4,s))||"",i},clear_prepend:function(e,s){return e.replace(s,"")},update_fields:function(e,i){s=this.fields._wrapped[2],s.$el.find("#"+s.get_field_id()).slider("value",i.radius),s.get_field().val(i.radius),s.trigger("changed")}});return d});